generator client {
    provider = "prisma-client-js"
    output   = "../generated/client"
}

datasource db {
    provider = "postgres"
    url      = env("DB_URL")
}

model User {
    id             Int              @id @default(autoincrement())
    login          String
    password       String
    balance        Decimal          @default(0.00)
    isActive       Boolean          @default(true) @map("is_active") // На мой взгляд, хороший тон не удалять записи, тем более пользователей, а иметь возможность "деперсонализации"
    createdAt      DateTime         @default(now()) @map("created_at")
    updatedAt      DateTime         @updatedAt @map("updated_at")
    balanceHistory BalanceHistory[]
    Items          Item[]

    @@map("users")
}

enum BalanceHistoryActionType {
    WITHDRAW
    DEPOSIT
}

model BalanceHistory {
    id     Int                      @id @default(autoincrement())
    userId Int                      @map("user_id")
    action BalanceHistoryActionType
    amount Decimal
    ts     DateTime                 @default(now())

    user User @relation(fields: [userId], references: [id])

    @@map("balance_histories")
}

model Item {
    id          String   @id @default(uuid())
    description String
    price       Decimal  @default(0.00)
    ownerId     Int?     @map("owner_id")
    createdAt   DateTime @default(now()) @map("created_at")
    updatedAt   DateTime @updatedAt @map("updated_at")

    user User? @relation(fields: [ownerId], references: [id])

    @@map("items")
}
